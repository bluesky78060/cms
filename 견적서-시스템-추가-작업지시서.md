# 📋 견적서 시스템 추가 - 작업 지시서

## 🎯 목표
기존 건축주 관리 데이터를 활용하여 견적서 생성 및 관리 기능을 추가합니다.

## 📊 시스템 구조 분석

### 기존 데이터 구조 활용
- **건축주 관리**: 기존 데이터 그대로 사용
- **작업 항목**: 견적서 작업내역 기반으로 활용
- **청구서**: 기존 시스템에 통합하여 유사한 구조로 견적서 구현

## 🔧 구현 작업 단계

### 1단계: 데이터 모델 확장

#### A. localStorage 키 추가
```javascript
// frontend/src/utils/localStorage.js에 추가
const STORAGE_KEYS = {
  COMPANY_INFO: 'construction_company_info',
  CLIENTS: 'construction_clients', 
  WORK_ITEMS: 'construction_work_items',
  INVOICES: 'construction_invoices',
  ESTIMATES: 'construction_estimates'  // 🆕 견적서 추가
};
```

#### B. 견적서 기본 데이터 정의
```javascript
// frontend/src/contexts/defaultData.js에 추가
export const DEFAULT_ESTIMATES = [
  {
    id: 1,
    clientId: 1,
    clientName: '김철수',
    projectName: '신축 주택',
    date: '2024-09-01',
    validUntil: '2024-10-01', // 견적 유효기간
    status: 'draft', // draft, sent, approved, rejected
    items: [
      {
        category: '기초공사',
        description: '기초 굴착 및 철근 배근',
        quantity: 20,
        unit: 'M²',
        unitPrice: 150000,
        totalPrice: 3000000,
        notes: '기초 깊이 1.2m로 시공'
      }
    ],
    subtotal: 3000000,
    tax: 300000,
    total: 3300000,
    notes: '견적 유효기간 내 승인 필요',
    terms: '착수금 30%, 중도금 40%, 잔금 30%' // 결제 조건
  }
];
```

### 2단계: Context 확장

#### AppContext에 견적서 관련 함수 추가
```javascript
// frontend/src/contexts/AppContext.js 수정
const [estimates, setEstimatesState] = useState(
  getStorageData('ESTIMATES', DEFAULT_ESTIMATES)
);

const setEstimates = (newEstimates) => {
  setEstimatesState(newEstimates);
  setStorageData('ESTIMATES', newEstimates);
};

// 견적서 관련 함수들
const addEstimate = (estimate) => { /* 구현 */ };
const updateEstimate = (id, updatedEstimate) => { /* 구현 */ };
const deleteEstimate = (id) => { /* 구현 */ };
const convertEstimateToInvoice = (estimateId) => { /* 구현 */ };
```

### 3단계: 견적서 컴포넌트 생성

#### A. 견적서 목록 페이지
```jsx
// frontend/src/components/Estimates.js 생성
- 견적서 목록 표시
- 상태별 필터링 (초안, 발송, 승인, 거절)
- 견적서 생성/편집/삭제
- PDF 출력 기능
- 청구서 변환 기능
```

#### B. 견적서 생성/편집 모달
```jsx
// 견적서 작성 폼
- 건축주 선택 (기존 데이터 활용)
- 프로젝트명 입력
- 작업 항목 추가 (기존 작업 항목 참조 가능)
- 견적 유효기간 설정
- 결제 조건 입력
- 특별 약관 입력
```

#### C. 견적서 상세보기/인쇄 뷰
```jsx
// 견적서 출력 템플릿
- 회사 정보 (기존 업체 정보 활용)
- 고객 정보
- 견적 항목 상세
- 총액 및 세액
- 유효기간 및 조건
- 한국어 금액 표기
```

### 4단계: UI/UX 개선

#### A. 네비게이션 메뉴 추가
```jsx
// frontend/src/components/Navbar.js 수정
<Link to="/estimates">
  📋 견적서 관리
</Link>
```

#### B. 라우팅 추가
```jsx
// frontend/src/App.js 수정
<Route path="/estimates" element={<Estimates />} />
```

#### C. 대시보드 통계 추가
```jsx
// 대시보드에 견적서 관련 통계 추가
- 대기 중인 견적서 수
- 이번 달 견적 총액
- 견적서 승인율
- 견적서 → 청구서 변환율
```

### 5단계: 고급 기능 구현

#### A. 견적서 템플릿 시스템
```javascript
// 자주 사용하는 견적 항목 템플릿
const ESTIMATE_TEMPLATES = {
  '단독주택신축': [
    { category: '기초공사', items: [...] },
    { category: '골조공사', items: [...] },
    { category: '마감공사', items: [...] }
  ],
  '리모델링': [...],
  '상가공사': [...]
};
```

#### B. 견적서 상태 관리
```javascript
// 견적서 워크플로우
const ESTIMATE_STATUS = {
  DRAFT: 'draft',        // 초안
  SENT: 'sent',          // 발송됨
  APPROVED: 'approved',  // 승인됨
  REJECTED: 'rejected',  // 거절됨
  EXPIRED: 'expired'     // 만료됨
};
```

#### C. 자동화 기능
```javascript
// 견적서 → 청구서 자동 변환
// 유효기간 만료 알림
// 견적 승인 시 프로젝트 자동 생성
```

### 6단계: Excel 연동 확장

#### A. 견적서 Excel 템플릿
```javascript
// frontend/src/utils/excelUtils.js 확장
export const exportEstimatesToExcel = () => { /* 구현 */ };
export const downloadEstimateTemplate = () => { /* 구현 */ };
export const importEstimatesFromExcel = () => { /* 구현 */ };
```

#### B. 견적서 전용 템플릿 생성
```
견적서_템플릿.xlsx:
- 견적번호
- 고객명
- 프로젝트명
- 견적일자
- 유효기간
- 작업항목 (카테고리, 설명, 수량, 단위, 단가)
- 총액
- 상태
- 비고
```

## 📋 구현 우선순위

### 🚀 1차 (필수 기능)
1. 견적서 데이터 모델 생성
2. 기본 CRUD 기능 구현
3. 견적서 목록 페이지
4. 견적서 생성/편집 폼
5. PDF 출력 기능

### 🚀 2차 (핵심 기능)
1. 견적서 상태 관리
2. 견적서 → 청구서 변환
3. Excel 가져오기/내보내기
4. 견적 템플릿 시스템

### 🚀 3차 (고급 기능)
1. 자동화 기능 (알림, 만료 체크)
2. 견적서 비교 기능
3. 고급 필터링 및 검색

## 🎯 예상 소요 시간

- **1차 구현**: 4-6시간
- **2차 구현**: 3-4시간  
- **3차 구현**: 2-3시간
- **총 소요 시간**: 9-13시간

## ✅ 완료 체크리스트

### 데이터 레이어
- [ ] localStorage 키 추가
- [ ] 견적서 기본 데이터 정의
- [ ] AppContext 견적서 함수 추가

### UI 컴포넌트
- [ ] Estimates.js 컴포넌트 생성
- [ ] 견적서 생성/편집 모달
- [ ] 견적서 PDF 출력 템플릿

### 라우팅 및 네비게이션
- [ ] 견적서 라우트 추가
- [ ] 네비게이션 메뉴 추가

### 기능 구현
- [ ] 견적서 CRUD 기능
- [ ] 상태 관리 시스템
- [ ] 견적서 → 청구서 변환

### Excel 연동
- [ ] 견적서 Excel 템플릿
- [ ] 가져오기/내보내기 기능

### 테스트 및 검증
- [ ] 기능 테스트
- [ ] 데이터 지속성 확인
- [ ] PDF 출력 확인
- [ ] Excel 연동 확인

## 🔄 기존 시스템과의 연동

### 데이터 흐름
```
건축주 관리 → 견적서 생성 → 견적서 승인 → 청구서 변환 → 작업 항목 연동
```

### 재사용 가능한 컴포넌트
- 건축주 선택 드롭다운
- 작업 항목 입력 폼
- PDF 출력 시스템
- 한국어 금액 변환 함수
- Excel 유틸리티

## 📝 주의사항

1. **기존 데이터 보존**: 현재 시스템의 건축주, 청구서 데이터 유지
2. **일관성 유지**: 기존 UI/UX 패턴과 일관된 디자인
3. **데이터 연동**: 견적서-청구서 간 데이터 정합성 보장
4. **성능 최적화**: localStorage 용량 고려한 데이터 구조
5. **사용자 경험**: 직관적이고 편리한 견적서 작성 흐름

---

**이 작업 지시서대로 구현하면 기존 시스템과 완벽하게 통합된 견적서 관리 시스템이 완성됩니다!** 🎉