기술 사양서: 하이브리드 클라이언트-서버 인증 시스템
1. 개요
본 문서는 GitHub Pages 기반의 정적 프론트엔드 웹사이트와 Google Cloud 기반의 백엔드 서버를 결합하여 특정 사용자만 접근 가능한 하이브리드 인증 시스템의 기술 사양을 정의합니다. 시스템의 핵심 목표는 웹사이트의 공개성을 유지하면서, 데이터는 사용자 컴퓨터에 로컬로 저장하고, 접근 권한은 개발자가 관리하는 것입니다.

이 시스템은 클라이언트 측 인증의 한계(코드 노출, 키 복제)를 보완하고, 서버 측 인증의 복잡성(데이터베이스 관리)을 최소화합니다.

2. 시스템 구성 (System Architecture)
프론트엔드: HTML, CSS, JavaScript로 구성된 정적 웹 애플리케이션. GitHub Pages에 배포되며, 사용자의 브라우저에서 실행됩니다.

백엔드: Node.js/Express로 구현된 소규모 API 서버. Google Cloud Run 또는 Cloud Functions와 같은 서버리스 환경에 배포됩니다. 이 서버는 보안 키 생성 및 인증 로직을 담당합니다.

클라우드 스토리지: Google Cloud Storage에 저장된 비밀 보안 문서. API 서버만 접근 가능하도록 **비공개(Private)**로 설정됩니다.

데이터 흐름:

사용자 등록: 개발자(운영자)는 사용자의 브라우저 지문과 비밀 문서를 결합하여 암호화된 보안 키를 생성합니다.

클라이언트 인증: 사용자는 웹사이트에 접속 시, 로컬 스토리지에 저장된 보안 키와 현재 브라우저 지문을 결합하여 유효성을 검증합니다.

데이터 관리: 모든 사용자 데이터는 서버를 거치지 않고, 각 사용자의 브라우저 로컬 스토리지(localStorage) 또는 IndexedDB에 저장됩니다.

3. 기술 스택
프론트엔드: HTML5, CSS3, JavaScript (ES6+)

브라우저 지문 라이브러리: FingerprintJS 또는 유사 라이브러리

암호화: Web Cryptography API 또는 JS 기반 라이브러리 (e.g., crypto-js)

로컬 저장소: localStorage 또는 IndexedDB

백엔드: Node.js, Express

HTTP 클라이언트: axios 또는 node-fetch

암호화: Node.js crypto 모듈

클라우드 연동: Google Cloud SDK for Node.js (@google-cloud/storage)

클라우드 환경: Google Cloud Platform (GCP)

서버: Cloud Run, Cloud Functions

스토리지: Cloud Storage

4. 주요 기능 및 구현 로직
4.1. 사용자 등록 및 키 생성 (개발자 전용)
브라우저 지문 수집: 개발자는 사용자에게 특정 URL에 접속하게 하여 JavaScript로 사용자의 고유한 브라우저 지문(예: OS, 해상도, 플러그인 등)을 수집합니다.

서버 요청: 개발자는 수집된 브라우저 지문을 백엔드 API에 전달합니다.

서버 로직:

@google-cloud/storage SDK를 사용하여 클라우드 스토리지에 저장된 비밀 문서를 읽어옵니다.

Node.js crypto 모듈로 비밀 문서의 특정 부분을 무작위로 추출하여 baseKey를 생성합니다.

baseKey와 클라이언트가 보낸 브라우저 지문 문자열을 결합하여 고유한 secretKey를 만듭니다.

secretKey를 AES-256 등의 알고리즘으로 암호화하여 최종 보안 키를 생성합니다.

키 전달: 서버는 생성된 암호화된 보안 키를 개발자에게 반환하며, 개발자는 이 키를 사용자에게 안전하게 전달합니다.

4.2. 클라이언트 측 인증 로직
최초 접근: 사용자는 전달받은 보안 키를 업로드합니다.

키 저장: 업로드된 키는 암호화된 상태로 localStorage.setItem('authKey', uploadedKey)를 통해 저장됩니다.

로그인 처리:

웹 앱은 localStorage.getItem('authKey')로 저장된 키를 가져옵니다.

현재 브라우저 지문을 다시 수집합니다.

저장된 키를 복호화하고, 현재의 브라우저 지문과 일치하는지 확인합니다.

인증 성공: 지문이 일치하면 웹 앱의 모든 기능이 활성화됩니다.

인증 실패: 지문이 일치하지 않으면 "접근 권한이 없습니다"와 같은 메시지를 표시합니다. 이는 다른 컴퓨터에 키를 복사한 경우 발생합니다.

5. 보안 고려사항
HTTPS 통신: 모든 클라이언트-서버 통신은 반드시 HTTPS 프로토콜을 사용해야 합니다.

API 키 및 비밀 정보: Google Cloud Platform의 API 키, 서비스 계정 키 파일 등은 절대 클라이언트 측 코드에 포함시켜서는 안 됩니다. 서버 환경 변수로 관리해야 합니다.

지문 불안정성: 브라우저 지문은 사용자의 브라우저 업데이트, 설정 변경, VPN 사용 등에 따라 바뀔 수 있습니다. 이 경우, 사용자가 재인증을 해야 하므로, 관련 안내 메시지를 친절하게 제공해야 합니다.

코드 난독화: JavaScript 코드를 난독화(Obfuscation)하여 키 생성 및 검증 로직을 쉽게 파악하지 못하도록 방지할 수 있습니다.

키 갱신: 주기적으로 보안 키를 갱신하거나, 사용자가 원할 때 재발급할 수 있는 기능을 제공하여 보안을 강화할 수 있습니다.